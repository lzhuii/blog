<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Hadoop 大数据平台搭建过程（集群） | 空影星辉</title>
<meta name="keywords" content="大数据, Hadoop, Hive, Spark">
<meta name="description" content="集群规划 节点 hadoop101 hadoop102 hadoop103 IP 192.168.1.101 192.168.1.102 192.168.1.103 配置 8C 16G 4C 8G 4C 8G 组件 NameNode SecondaryNameNode ResourceManager DataNode DataNode DataNode NodeManager NodeManager NodeManager MySQL、Hive 安装系统 下载系统镜像 Anolis OS 8.8
创建虚拟机 创建虚拟机 hadoop101
系统通用配置 安装必要的软件，关闭防火墙
1 2 3 4 5 6 dnf install -y tar vim wget systemctl stop firewalld systemctl disable firewalld setenforce 0 iptables -F 配置 hosts
1 vim /etc/hosts 1 2 3 192.168.1.101 hadoop101 192.168.1.102 hadoop102 192.">
<meta name="author" content="空影星辉">
<link rel="canonical" href="https://lzhuii.github.io/posts/hadoop%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E9%9B%86%E7%BE%A4/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://lzhuii.github.io/img/avatar.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="https://lzhuii.github.io/img/avatar.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="https://lzhuii.github.io/img/avatar.jpg">
<link rel="apple-touch-icon" href="https://lzhuii.github.io/img/avatar.jpg">
<link rel="mask-icon" href="https://lzhuii.github.io/img/avatar.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Hadoop 大数据平台搭建过程（集群）" />
<meta property="og:description" content="集群规划 节点 hadoop101 hadoop102 hadoop103 IP 192.168.1.101 192.168.1.102 192.168.1.103 配置 8C 16G 4C 8G 4C 8G 组件 NameNode SecondaryNameNode ResourceManager DataNode DataNode DataNode NodeManager NodeManager NodeManager MySQL、Hive 安装系统 下载系统镜像 Anolis OS 8.8
创建虚拟机 创建虚拟机 hadoop101
系统通用配置 安装必要的软件，关闭防火墙
1 2 3 4 5 6 dnf install -y tar vim wget systemctl stop firewalld systemctl disable firewalld setenforce 0 iptables -F 配置 hosts
1 vim /etc/hosts 1 2 3 192.168.1.101 hadoop101 192.168.1.102 hadoop102 192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lzhuii.github.io/posts/hadoop%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E9%9B%86%E7%BE%A4/" /><meta property="og:image" content="https://lzhuii.github.io/img/avatar.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-20T00:00:00+08:00" />
<meta property="article:modified_time" content="2023-12-20T00:00:00+08:00" /><meta property="og:site_name" content="空影星辉" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://lzhuii.github.io/img/avatar.jpg"/>

<meta name="twitter:title" content="Hadoop 大数据平台搭建过程（集群）"/>
<meta name="twitter:description" content="集群规划 节点 hadoop101 hadoop102 hadoop103 IP 192.168.1.101 192.168.1.102 192.168.1.103 配置 8C 16G 4C 8G 4C 8G 组件 NameNode SecondaryNameNode ResourceManager DataNode DataNode DataNode NodeManager NodeManager NodeManager MySQL、Hive 安装系统 下载系统镜像 Anolis OS 8.8
创建虚拟机 创建虚拟机 hadoop101
系统通用配置 安装必要的软件，关闭防火墙
1 2 3 4 5 6 dnf install -y tar vim wget systemctl stop firewalld systemctl disable firewalld setenforce 0 iptables -F 配置 hosts
1 vim /etc/hosts 1 2 3 192.168.1.101 hadoop101 192.168.1.102 hadoop102 192."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://lzhuii.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Hadoop 大数据平台搭建过程（集群）",
      "item": "https://lzhuii.github.io/posts/hadoop%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E9%9B%86%E7%BE%A4/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hadoop 大数据平台搭建过程（集群）",
  "name": "Hadoop 大数据平台搭建过程（集群）",
  "description": "集群规划 节点 hadoop101 hadoop102 hadoop103 IP 192.168.1.101 192.168.1.102 192.168.1.103 配置 8C 16G 4C 8G 4C 8G 组件 NameNode SecondaryNameNode ResourceManager DataNode DataNode DataNode NodeManager NodeManager NodeManager MySQL、Hive 安装系统 下载系统镜像 Anolis OS 8.8\n创建虚拟机 创建虚拟机 hadoop101\n系统通用配置 安装必要的软件，关闭防火墙\n1 2 3 4 5 6 dnf install -y tar vim wget systemctl stop firewalld systemctl disable firewalld setenforce 0 iptables -F 配置 hosts\n1 vim /etc/hosts 1 2 3 192.168.1.101 hadoop101 192.168.1.102 hadoop102 192.",
  "keywords": [
    "大数据", "Hadoop", "Hive", "Spark"
  ],
  "articleBody": "集群规划 节点 hadoop101 hadoop102 hadoop103 IP 192.168.1.101 192.168.1.102 192.168.1.103 配置 8C 16G 4C 8G 4C 8G 组件 NameNode SecondaryNameNode ResourceManager DataNode DataNode DataNode NodeManager NodeManager NodeManager MySQL、Hive 安装系统 下载系统镜像 Anolis OS 8.8\n创建虚拟机 创建虚拟机 hadoop101\n系统通用配置 安装必要的软件，关闭防火墙\n1 2 3 4 5 6 dnf install -y tar vim wget systemctl stop firewalld systemctl disable firewalld setenforce 0 iptables -F 配置 hosts\n1 vim /etc/hosts 1 2 3 192.168.1.101 hadoop101 192.168.1.102 hadoop102 192.168.1.103 hadoop103 配置主机名\n1 vim /etc/hostname 1 hadoop101 配置静态地址\n1 vim /etc/sysconfig/network-scripts/ifcfg-ens33 1 2 3 4 5 ...... IPADDR=192.168.1.101 PREFIX=24 GATEWAY=192.168.1.1 DNS1=192.168.1.1 创建 hadoop 用户 创建用户\n1 2 3 4 5 mkdir /user useradd -d /user/hadoop -m hadoop passwd hadoop 123456 123456 添加 sudo 权限\n1 2 visudo hadoop ALL=(ALL) NOPASSWD: ALL 克隆虚拟机 创建 hadoop101 的快照，克隆虚拟机 hadoop102、hadoop103，并修改为 4C 8G\n修改 hadoop102、hadoop103 的 IP 和主机名\n登录三台服务器，配置 SSH 免密登录\n1 2 3 4 5 # hadoop 用户 ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa ssh-copy-id hadoop101 ssh-copy-id hadoop102 ssh-copy-id hadoop103 安装集群 使用 MobaXterm 的 Multi-execution mode 功能同时操作三台服务器\n安装 Java 8 下载 Java 8\n解压并配置环境变量\n1 2 3 4 5 6 7 8 9 sudo tar xvf jdk-8u381-linux-x64.tar.gz -C /usr/local/ sudo vim /etc/profile.d/server.sh # JAVA 8 export JAVA_HOME=/usr/local/jdk1.8.0_381 export PATH=$PATH:$JAVA_HOME/bin source /etc/profile java -version 安装 Hadoop 3.3.6 下载 Hadoop 3.3.6\n解压并配置环境变量\n1 2 3 4 5 6 7 8 9 10 sudo tar xvf hadoop-3.3.6.tar.gz -C /usr/local/ sudo vim /etc/profile.d/server.sh # HADOOP 3.3.6 export HADOOP_HOME=/usr/local/hadoop-3.3.6 export PATH=$PATH:$HADOOP_HOME/bin export PATH=$PATH:$HADOOP_HOME/sbin source /etc/profile hadoop version 修改配置文件\nhadoop-env.sh 1 vim $HADOOP_HOME/etc/hadoop/hadoop-env.sh 1 export JAVA_HOME=/usr/local/jdk1.8.0_381 core-site.xml 1 vim $HADOOP_HOME/etc/hadoop/core-site.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?\u003e fs.defaultFS hdfs://hadoop101:8020 hadoop.tmp.dir /usr/local/hadoop-3.3.6/data hadoop.http.staticuser.user hadoop hadoop.proxyuser.hadoop.hosts * hadoop.proxyuser.hadoop.groups * hdfs-site.xml 1 vim $HADOOP_HOME/etc/hadoop/hdfs-site.xml 1 2 3 4 5 6 7 8 9 10 11 12 \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?\u003e dfs.namenode.http-address hadoop101:9870 dfs.namenode.secondary.http-address hadoop102:9868 mapred-site.xml 1 vim $HADOOP_HOME/etc/hadoop/mapred-site.xml 1 2 3 4 5 6 7 8 \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?\u003e mapreduce.framework.name yarn yarn-site.xml 1 vim $HADOOP_HOME/etc/hadoop/yarn-site.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?\u003e yarn.nodemanager.aux-services mapreduce_shuffle yarn.resourcemanager.hostname hadoop103 yarn.nodemanager.env-whitelist JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME workers 1 vim $HADOOP_HOME/etc/hadoop/workers 1 2 3 hadoop101 hadoop102 hadoop103 在 hadoop101 节点启动 HDFS、在 hadoop103 节点启动 YARN\n1 2 3 4 5 6 7 8 9 10 11 # hadoop101 hdfs namenode -format start-dfs.sh hdfs dfs -mkdir -p /user/hadoop hdfs dfs -chown -R hadoop:hadoop /user/hadoop hdfs dfs -mkdir -p /user/hive/warehouse hdfs dfs -chown -R hadoop:hadoop /user/hive # hadoop103 start-yarn.sh 检查 HDFS 和 YARN 的进程是否正确启动\n访问\nhttp://hadoop101:9870\nhttp://hadoop103:8088\n安装 MySQL 8.0 安装 mysql-server 并修改 root 密码\n1 2 3 4 5 6 7 8 9 # 安装 mysql-server sudo dnf install -y mysql-server # 启动 mysqld 服务 sudo systemctl start mysqld # 修改 root 密码 sudo mysqladmin -u root -p password # 默认为空 # 123456 # 123456 开启远程访问，创建 hive 元数据库\n1 2 3 4 5 6 mysql -uroot -p123456 use mysql; update user set host = '%' where user = 'root'; flush privileges; create database metastore; exit 安装 Hive 3.1.3 下载 Hive 3.1.3\n解压并配置环境变量\n1 2 3 4 5 6 7 8 9 10 11 sudo tar xvf apache-hive-3.1.3-bin.tar.gz -C /usr/local sudo mv /usr/local/apache-hive-3.1.3-bin /usr/local/hive-3.1.3 sudo chown -R hadoop:hadoop /usr/local/hive-3.1.3 sudo vim /etc/profile.d/server.sh # HIVE 3.1.3 export HIVE_HOME=/usr/local/hive-3.1.3 export PATH=$PATH:$HIVE_HOME/bin source /etc/profile hive --version 创建 hive 配置文件\n1 vim $HIVE_HOME/conf/hive-site.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 \u003c?xml version=\"1.0\"?\u003e \u003c?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?\u003e javax.jdo.option.ConnectionURL jdbc:mysql://hadoop101:3306/metastore?useSSL=false javax.jdo.option.ConnectionDriverName com.mysql.jdbc.Driver javax.jdo.option.ConnectionUserName root javax.jdo.option.ConnectionPassword 123456 hive.metastore.schema.verification false hive.metastore.event.db.notification.api.auth false hive.metastore.warehouse.dir /user/hive/warehouse hive.metastore.uris thrift://hadoop101:9083 hive.server2.thrift.bind.host hadoop101 hive.server2.thrift.port 10000 hive.cli.print.header true hive.cli.print.current.db true 在 hadoop101 节点初始化 hive 元数据库，启动 hive\n1 2 3 4 5 wget -O $HIVE_HOME/lib/mysql-connector-java-5.1.49.jar https://oss.lzhui.top/common/mysql-connector-java-5.1.49.jar schematool -initSchema -dbType mysql -verbose mkdir -p $HIVE_HOME/log nohup hive --service metastore \u003e $HIVE_HOME/log/metastore.log 2\u003e\u00261 \u0026 nohup hive --service hiveserver2 \u003e $HIVE_HOME/log/hiveserver2.log 2\u003e\u00261 \u0026 安装 Spark 3.5.0 下载 Spark 3.5.0\n解压并配置环境变量\n1 2 sudo tar xvf spark-3.5.0-bin-hadoop3-scala2.13.tgz -C /usr/local sudo mv /usr/local/spark-3.5.0-bin-hadoop3-scala2.13 /usr/local/spark-3.5.0 快速搭建脚本 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 # hadoop101 hadoop102 hadoop103 sudo tar xvf jdk-8u381-linux-x64.tar.gz -C /usr/local sudo tar xvf hadoop-3.3.6.tar.gz -C /usr/local sudo tar xvf apache-hive-3.1.3-bin.tar.gz -C /usr/local sudo mv /usr/local/apache-hive-3.1.3-bin /usr/local/hive-3.1.3 sudo chown -R hadoop:hadoop /usr/local/hive-3.1.3 sudo wget -O /etc/profile.d/server.sh https://oss.lzhui.top/common/server.sh source /etc/profile java -version hadoop version hive --version wget -O $HADOOP_HOME/etc/hadoop/hadoop-env.sh https://oss.lzhui.top/common/hadoop-env.sh wget -O $HADOOP_HOME/etc/hadoop/workers https://oss.lzhui.top/common/workers wget -O $HADOOP_HOME/etc/hadoop/core-site.xml https://oss.lzhui.top/common/core-site.xml wget -O $HADOOP_HOME/etc/hadoop/hdfs-site.xml https://oss.lzhui.top/common/hdfs-site.xml wget -O $HADOOP_HOME/etc/hadoop/mapred-site.xml https://oss.lzhui.top/common/mapred-site.xml wget -O $HADOOP_HOME/etc/hadoop/yarn-site.xml https://oss.lzhui.top/common/yarn-site.xml wget -O $HIVE_HOME/conf/hive-site.xml https://oss.lzhui.top/common/hive-site.xml wget -O $HIVE_HOME/lib/mysql-connector-java-5.1.49.jar https://oss.lzhui.top/common/mysql-connector-java-5.1.49.jar # hadoop101 hdfs namenode -format start-dfs.sh hdfs dfs -mkdir -p /user/hadoop hdfs dfs -chown -R hadoop:hadoop /user/hadoop hdfs dfs -mkdir -p /user/hive/warehouse hdfs dfs -chown -R hadoop:hadoop /user/hive sudo dnf install -y mysql-server sudo systemctl start mysqld mysql -u root alter user 'root'@'localhost' identified by '123456'; use mysql; update user set host = '%' where user = 'root'; flush privileges; create database metastore; exit schematool -initSchema -dbType mysql -verbose mkdir -p $HIVE_HOME/log nohup hive --service metastore \u003e $HIVE_HOME/log/metastore.log 2\u003e\u00261 \u0026 nohup hive --service hiveserver2 \u003e $HIVE_HOME/log/hiveserver2.log 2\u003e\u00261 \u0026 # hadoop103 start-yarn.sh ",
  "wordCount" : "976",
  "inLanguage": "zh",
  "datePublished": "2023-12-20T00:00:00+08:00",
  "dateModified": "2023-12-20T00:00:00+08:00",
  "author":{
    "@type": "Person",
    "name": "空影星辉"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lzhuii.github.io/posts/hadoop%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%E9%9B%86%E7%BE%A4/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "空影星辉",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lzhuii.github.io/img/avatar.jpg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lzhuii.github.io/" accesskey="h" title="空影星辉 (Alt + H)">
                <img src="https://lzhuii.github.io/img/avatar.jpg" alt="" aria-label="logo"
                    height="35">空影星辉</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lzhuii.github.io/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://lzhuii.github.io/archives/" title="时间轴">
                    <span>时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://lzhuii.github.io/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lzhuii.github.io/">主页</a>&nbsp;»&nbsp;<a href="https://lzhuii.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Hadoop 大数据平台搭建过程（集群）
    </h1>
    <div class="post-meta"><span title='2023-12-20 00:00:00 +0800 CST'>2023年12月20日 00:00:00</span>&nbsp;·&nbsp;5 分钟&nbsp;·&nbsp;976 字&nbsp;·&nbsp;空影星辉

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#集群规划">集群规划</a></li>
    <li><a href="#安装系统">安装系统</a>
      <ul>
        <li><a href="#下载系统镜像">下载系统镜像</a></li>
        <li><a href="#创建虚拟机">创建虚拟机</a></li>
        <li><a href="#系统通用配置">系统通用配置</a></li>
        <li><a href="#创建-hadoop-用户">创建 hadoop 用户</a></li>
        <li><a href="#克隆虚拟机">克隆虚拟机</a></li>
      </ul>
    </li>
    <li><a href="#安装集群">安装集群</a>
      <ul>
        <li><a href="#安装-java-8">安装 Java 8</a></li>
        <li><a href="#安装-hadoop-336">安装 Hadoop 3.3.6</a></li>
        <li><a href="#安装-mysql-80">安装 MySQL 8.0</a></li>
        <li><a href="#安装-hive-313">安装 Hive 3.1.3</a></li>
        <li><a href="#安装-spark-350">安装 Spark 3.5.0</a></li>
      </ul>
    </li>
    <li><a href="#快速搭建脚本">快速搭建脚本</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="集群规划">集群规划<a hidden class="anchor" aria-hidden="true" href="#集群规划">#</a></h2>
<table>
<thead>
<tr>
<th>节点</th>
<th>hadoop101</th>
<th>hadoop102</th>
<th>hadoop103</th>
</tr>
</thead>
<tbody>
<tr>
<td>IP</td>
<td>192.168.1.101</td>
<td>192.168.1.102</td>
<td>192.168.1.103</td>
</tr>
<tr>
<td>配置</td>
<td>8C 16G</td>
<td>4C 8G</td>
<td>4C 8G</td>
</tr>
<tr>
<td>组件</td>
<td>NameNode</td>
<td>SecondaryNameNode</td>
<td>ResourceManager</td>
</tr>
<tr>
<td></td>
<td>DataNode</td>
<td>DataNode</td>
<td>DataNode</td>
</tr>
<tr>
<td></td>
<td>NodeManager</td>
<td>NodeManager</td>
<td>NodeManager</td>
</tr>
<tr>
<td></td>
<td>MySQL、Hive</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="安装系统">安装系统<a hidden class="anchor" aria-hidden="true" href="#安装系统">#</a></h2>
<h3 id="下载系统镜像">下载系统镜像<a hidden class="anchor" aria-hidden="true" href="#下载系统镜像">#</a></h3>
<p><a href="https://mirrors.openanolis.cn/anolis/8.8/isos/GA/x86_64/AnolisOS-8.8-x86_64-minimal.iso">Anolis OS 8.8</a></p>
<h3 id="创建虚拟机">创建虚拟机<a hidden class="anchor" aria-hidden="true" href="#创建虚拟机">#</a></h3>
<p>创建虚拟机 hadoop101</p>
<p><img loading="lazy" src="https://oss.lzhui.top/blog/image-20231224113345710.png" alt="image-20231224113345710"  />
</p>
<h3 id="系统通用配置">系统通用配置<a hidden class="anchor" aria-hidden="true" href="#系统通用配置">#</a></h3>
<ol>
<li>
<p>安装必要的软件，关闭防火墙</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dnf install -y tar vim wget
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl stop firewalld
</span></span><span class="line"><span class="cl">systemctl disable firewalld
</span></span><span class="line"><span class="cl">setenforce <span class="m">0</span>
</span></span><span class="line"><span class="cl">iptables -F
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置 hosts</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/hosts
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">192.168.1.101 hadoop101
</span></span><span class="line"><span class="cl">192.168.1.102 hadoop102
</span></span><span class="line"><span class="cl">192.168.1.103 hadoop103
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置主机名</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/hostname
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hadoop101
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置静态地址</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/sysconfig/network-scripts/ifcfg-ens33
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">......
</span></span><span class="line"><span class="cl"><span class="nv">IPADDR</span><span class="o">=</span>192.168.1.101
</span></span><span class="line"><span class="cl"><span class="nv">PREFIX</span><span class="o">=</span><span class="m">24</span>
</span></span><span class="line"><span class="cl"><span class="nv">GATEWAY</span><span class="o">=</span>192.168.1.1
</span></span><span class="line"><span class="cl"><span class="nv">DNS1</span><span class="o">=</span>192.168.1.1
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="创建-hadoop-用户">创建 hadoop 用户<a hidden class="anchor" aria-hidden="true" href="#创建-hadoop-用户">#</a></h3>
<ol>
<li>
<p>创建用户</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir /user
</span></span><span class="line"><span class="cl">useradd -d /user/hadoop -m hadoop
</span></span><span class="line"><span class="cl">passwd hadoop
</span></span><span class="line"><span class="cl"><span class="m">123456</span>
</span></span><span class="line"><span class="cl"><span class="m">123456</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>添加 sudo 权限</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">visudo
</span></span><span class="line"><span class="cl">hadoop  <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>       NOPASSWD: ALL
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="克隆虚拟机">克隆虚拟机<a hidden class="anchor" aria-hidden="true" href="#克隆虚拟机">#</a></h3>
<ol>
<li>
<p>创建 hadoop101 的快照，克隆虚拟机 hadoop102、hadoop103，并修改为 4C 8G</p>
<p><img loading="lazy" src="https://oss.lzhui.top/blog/image-20231224113519873.png" alt="image-20231224113519873"  />
</p>
</li>
<li>
<p>修改 hadoop102、hadoop103 的 IP 和主机名</p>
</li>
<li>
<p>登录三台服务器，配置 SSH 免密登录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># hadoop 用户</span>
</span></span><span class="line"><span class="cl">ssh-keygen -t rsa -P <span class="s1">&#39;&#39;</span> -f ~/.ssh/id_rsa
</span></span><span class="line"><span class="cl">ssh-copy-id hadoop101
</span></span><span class="line"><span class="cl">ssh-copy-id hadoop102
</span></span><span class="line"><span class="cl">ssh-copy-id hadoop103
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="安装集群">安装集群<a hidden class="anchor" aria-hidden="true" href="#安装集群">#</a></h2>
<p>使用 MobaXterm 的 Multi-execution mode 功能同时操作三台服务器</p>
<p><img loading="lazy" src="https://oss.lzhui.top/blog/image-20231224182417167.png" alt="image-20231224182417167"  />
</p>
<h3 id="安装-java-8">安装 Java 8<a hidden class="anchor" aria-hidden="true" href="#安装-java-8">#</a></h3>
<ol>
<li>
<p>下载 <a href="https://www.oracle.com/cn/java/technologies/javase/javase8u211-later-archive-downloads.html">Java 8</a></p>
</li>
<li>
<p>解压并配置环境变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tar xvf jdk-8u381-linux-x64.tar.gz -C /usr/local/
</span></span><span class="line"><span class="cl">sudo vim /etc/profile.d/server.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># JAVA 8</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">JAVA_HOME</span><span class="o">=</span>/usr/local/jdk1.8.0_381
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$JAVA_HOME</span>/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">source</span> /etc/profile
</span></span><span class="line"><span class="cl">java -version
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="安装-hadoop-336">安装 Hadoop 3.3.6<a hidden class="anchor" aria-hidden="true" href="#安装-hadoop-336">#</a></h3>
<ol>
<li>
<p>下载 <a href="https://mirrors.bfsu.edu.cn/apache/hadoop/common/hadoop-3.3.6/hadoop-3.3.6.tar.gz">Hadoop 3.3.6</a></p>
</li>
<li>
<p>解压并配置环境变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tar xvf hadoop-3.3.6.tar.gz -C /usr/local/
</span></span><span class="line"><span class="cl">sudo vim /etc/profile.d/server.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># HADOOP 3.3.6</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_HOME</span><span class="o">=</span>/usr/local/hadoop-3.3.6
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$HADOOP_HOME</span>/bin
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$HADOOP_HOME</span>/sbin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">source</span> /etc/profile
</span></span><span class="line"><span class="cl">hadoop version
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>修改配置文件</p>
<ul>
<li><strong>hadoop-env.sh</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim <span class="nv">$HADOOP_HOME</span>/etc/hadoop/hadoop-env.sh
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">JAVA_HOME</span><span class="o">=</span>/usr/local/jdk1.8.0_381
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>core-site.xml</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim <span class="nv">$HADOOP_HOME</span>/etc/hadoop/core-site.xml
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;configuration.xsl&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>fs.defaultFS<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>hdfs://hadoop101:8020<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hadoop.tmp.dir<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>/usr/local/hadoop-3.3.6/data<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hadoop.http.staticuser.user<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>hadoop<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hadoop.proxyuser.hadoop.hosts<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>*<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hadoop.proxyuser.hadoop.groups<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>*<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>hdfs-site.xml</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim <span class="nv">$HADOOP_HOME</span>/etc/hadoop/hdfs-site.xml
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;configuration.xsl&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.namenode.http-address<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>hadoop101:9870<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.namenode.secondary.http-address<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>hadoop102:9868<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>mapred-site.xml</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim <span class="nv">$HADOOP_HOME</span>/etc/hadoop/mapred-site.xml
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;configuration.xsl&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>mapreduce.framework.name<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>yarn<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>yarn-site.xml</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim <span class="nv">$HADOOP_HOME</span>/etc/hadoop/yarn-site.xml
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;configuration.xsl&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>yarn.nodemanager.aux-services<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>mapreduce_shuffle<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>yarn.resourcemanager.hostname<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>hadoop103<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>yarn.nodemanager.env-whitelist<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>workers</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim <span class="nv">$HADOOP_HOME</span>/etc/hadoop/workers
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hadoop101
</span></span><span class="line"><span class="cl">hadoop102
</span></span><span class="line"><span class="cl">hadoop103
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在 hadoop101 节点启动 HDFS、在 hadoop103 节点启动 YARN</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># hadoop101</span>
</span></span><span class="line"><span class="cl">hdfs namenode -format
</span></span><span class="line"><span class="cl">start-dfs.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">hdfs dfs -mkdir -p /user/hadoop
</span></span><span class="line"><span class="cl">hdfs dfs -chown -R hadoop:hadoop /user/hadoop
</span></span><span class="line"><span class="cl">hdfs dfs -mkdir -p /user/hive/warehouse
</span></span><span class="line"><span class="cl">hdfs dfs -chown -R hadoop:hadoop /user/hive
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hadoop103</span>
</span></span><span class="line"><span class="cl">start-yarn.sh
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>检查 HDFS 和 YARN 的进程是否正确启动</p>
<p><img loading="lazy" src="https://oss.lzhui.top/blog/image-20231224195156615.png" alt="image-20231224195156615"  />
</p>
</li>
<li>
<p>访问</p>
</li>
</ol>
<ul>
<li>
<p><a href="http://hadoop101:9870">http://hadoop101:9870</a></p>
</li>
<li>
<p><a href="http://hadoop103:8088">http://hadoop103:8088</a></p>
</li>
</ul>
<h3 id="安装-mysql-80">安装 MySQL 8.0<a hidden class="anchor" aria-hidden="true" href="#安装-mysql-80">#</a></h3>
<ol>
<li>
<p>安装 mysql-server 并修改 root 密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 安装 mysql-server</span>
</span></span><span class="line"><span class="cl">sudo dnf install -y mysql-server
</span></span><span class="line"><span class="cl"><span class="c1"># 启动 mysqld 服务</span>
</span></span><span class="line"><span class="cl">sudo systemctl start mysqld
</span></span><span class="line"><span class="cl"><span class="c1"># 修改 root 密码</span>
</span></span><span class="line"><span class="cl">sudo mysqladmin -u root -p password
</span></span><span class="line"><span class="cl"><span class="c1"># 默认为空</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 123456</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 123456</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>开启远程访问，创建 hive 元数据库</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -uroot -p123456
</span></span><span class="line"><span class="cl">use mysql<span class="p">;</span>
</span></span><span class="line"><span class="cl">update user <span class="nb">set</span> <span class="nv">host</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span> where <span class="nv">user</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">flush privileges<span class="p">;</span>
</span></span><span class="line"><span class="cl">create database metastore<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="安装-hive-313">安装 Hive 3.1.3<a hidden class="anchor" aria-hidden="true" href="#安装-hive-313">#</a></h3>
<ol>
<li>
<p>下载 <a href="https://mirrors.bfsu.edu.cn/apache/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz">Hive 3.1.3</a></p>
</li>
<li>
<p>解压并配置环境变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tar xvf apache-hive-3.1.3-bin.tar.gz -C /usr/local
</span></span><span class="line"><span class="cl">sudo mv /usr/local/apache-hive-3.1.3-bin /usr/local/hive-3.1.3
</span></span><span class="line"><span class="cl">sudo chown -R hadoop:hadoop /usr/local/hive-3.1.3
</span></span><span class="line"><span class="cl">sudo vim /etc/profile.d/server.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># HIVE 3.1.3</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HIVE_HOME</span><span class="o">=</span>/usr/local/hive-3.1.3
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$HIVE_HOME</span>/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">source</span> /etc/profile
</span></span><span class="line"><span class="cl">hive --version
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建 hive 配置文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim <span class="nv">$HIVE_HOME</span>/conf/hive-site.xml
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;configuration.xsl&#34;?&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>javax.jdo.option.ConnectionURL<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>jdbc:mysql://hadoop101:3306/metastore?useSSL=false<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>javax.jdo.option.ConnectionDriverName<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>com.mysql.jdbc.Driver<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>javax.jdo.option.ConnectionUserName<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>root<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>javax.jdo.option.ConnectionPassword<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>123456<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hive.metastore.schema.verification<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>false<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hive.metastore.event.db.notification.api.auth<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>false<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hive.metastore.warehouse.dir<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>/user/hive/warehouse<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hive.metastore.uris<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>thrift://hadoop101:9083<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hive.server2.thrift.bind.host<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>hadoop101<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hive.server2.thrift.port<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>10000<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hive.cli.print.header<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>true<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>hive.cli.print.current.db<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>true<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在 hadoop101 节点初始化 hive 元数据库，启动 hive</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -O <span class="nv">$HIVE_HOME</span>/lib/mysql-connector-java-5.1.49.jar https://oss.lzhui.top/common/mysql-connector-java-5.1.49.jar
</span></span><span class="line"><span class="cl">schematool -initSchema -dbType mysql -verbose
</span></span><span class="line"><span class="cl">mkdir -p <span class="nv">$HIVE_HOME</span>/log
</span></span><span class="line"><span class="cl">nohup hive --service metastore &gt; <span class="nv">$HIVE_HOME</span>/log/metastore.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">nohup hive --service hiveserver2 &gt; <span class="nv">$HIVE_HOME</span>/log/hiveserver2.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="安装-spark-350">安装 Spark 3.5.0<a hidden class="anchor" aria-hidden="true" href="#安装-spark-350">#</a></h3>
<ol>
<li>
<p>下载 <a href="https://mirrors.bfsu.edu.cn/apache/spark/spark-3.5.0/spark-3.5.0-bin-hadoop3-scala2.13.tgz">Spark 3.5.0</a></p>
</li>
<li>
<p>解压并配置环境变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tar xvf spark-3.5.0-bin-hadoop3-scala2.13.tgz -C /usr/local
</span></span><span class="line"><span class="cl">sudo mv /usr/local/spark-3.5.0-bin-hadoop3-scala2.13 /usr/local/spark-3.5.0
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="快速搭建脚本">快速搭建脚本<a hidden class="anchor" aria-hidden="true" href="#快速搭建脚本">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># hadoop101 hadoop102 hadoop103</span>
</span></span><span class="line"><span class="cl">sudo tar xvf jdk-8u381-linux-x64.tar.gz -C /usr/local
</span></span><span class="line"><span class="cl">sudo tar xvf hadoop-3.3.6.tar.gz -C /usr/local
</span></span><span class="line"><span class="cl">sudo tar xvf apache-hive-3.1.3-bin.tar.gz -C /usr/local
</span></span><span class="line"><span class="cl">sudo mv /usr/local/apache-hive-3.1.3-bin /usr/local/hive-3.1.3
</span></span><span class="line"><span class="cl">sudo chown -R hadoop:hadoop /usr/local/hive-3.1.3
</span></span><span class="line"><span class="cl">sudo wget -O /etc/profile.d/server.sh https://oss.lzhui.top/common/server.sh
</span></span><span class="line"><span class="cl"><span class="nb">source</span> /etc/profile
</span></span><span class="line"><span class="cl">java -version
</span></span><span class="line"><span class="cl">hadoop version
</span></span><span class="line"><span class="cl">hive --version
</span></span><span class="line"><span class="cl">wget -O <span class="nv">$HADOOP_HOME</span>/etc/hadoop/hadoop-env.sh https://oss.lzhui.top/common/hadoop-env.sh
</span></span><span class="line"><span class="cl">wget -O <span class="nv">$HADOOP_HOME</span>/etc/hadoop/workers https://oss.lzhui.top/common/workers
</span></span><span class="line"><span class="cl">wget -O <span class="nv">$HADOOP_HOME</span>/etc/hadoop/core-site.xml https://oss.lzhui.top/common/core-site.xml
</span></span><span class="line"><span class="cl">wget -O <span class="nv">$HADOOP_HOME</span>/etc/hadoop/hdfs-site.xml https://oss.lzhui.top/common/hdfs-site.xml
</span></span><span class="line"><span class="cl">wget -O <span class="nv">$HADOOP_HOME</span>/etc/hadoop/mapred-site.xml https://oss.lzhui.top/common/mapred-site.xml
</span></span><span class="line"><span class="cl">wget -O <span class="nv">$HADOOP_HOME</span>/etc/hadoop/yarn-site.xml https://oss.lzhui.top/common/yarn-site.xml
</span></span><span class="line"><span class="cl">wget -O <span class="nv">$HIVE_HOME</span>/conf/hive-site.xml https://oss.lzhui.top/common/hive-site.xml
</span></span><span class="line"><span class="cl">wget -O <span class="nv">$HIVE_HOME</span>/lib/mysql-connector-java-5.1.49.jar https://oss.lzhui.top/common/mysql-connector-java-5.1.49.jar
</span></span><span class="line"><span class="cl"><span class="c1"># hadoop101</span>
</span></span><span class="line"><span class="cl">hdfs namenode -format
</span></span><span class="line"><span class="cl">start-dfs.sh
</span></span><span class="line"><span class="cl">hdfs dfs -mkdir -p /user/hadoop
</span></span><span class="line"><span class="cl">hdfs dfs -chown -R hadoop:hadoop /user/hadoop
</span></span><span class="line"><span class="cl">hdfs dfs -mkdir -p /user/hive/warehouse
</span></span><span class="line"><span class="cl">hdfs dfs -chown -R hadoop:hadoop /user/hive
</span></span><span class="line"><span class="cl">sudo dnf install -y mysql-server
</span></span><span class="line"><span class="cl">sudo systemctl start mysqld
</span></span><span class="line"><span class="cl">mysql -u root
</span></span><span class="line"><span class="cl">alter user <span class="s1">&#39;root&#39;</span>@<span class="s1">&#39;localhost&#39;</span> identified by <span class="s1">&#39;123456&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">use mysql<span class="p">;</span>
</span></span><span class="line"><span class="cl">update user <span class="nb">set</span> <span class="nv">host</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span> where <span class="nv">user</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">flush privileges<span class="p">;</span>
</span></span><span class="line"><span class="cl">create database metastore<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span><span class="line"><span class="cl">schematool -initSchema -dbType mysql -verbose
</span></span><span class="line"><span class="cl">mkdir -p <span class="nv">$HIVE_HOME</span>/log
</span></span><span class="line"><span class="cl">nohup hive --service metastore &gt; <span class="nv">$HIVE_HOME</span>/log/metastore.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">nohup hive --service hiveserver2 &gt; <span class="nv">$HIVE_HOME</span>/log/hiveserver2.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hadoop103</span>
</span></span><span class="line"><span class="cl">start-yarn.sh
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lzhuii.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></li>
      <li><a href="https://lzhuii.github.io/tags/hadoop/">Hadoop</a></li>
      <li><a href="https://lzhuii.github.io/tags/hive/">Hive</a></li>
      <li><a href="https://lzhuii.github.io/tags/spark/">Spark</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lzhuii.github.io/posts/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E6%B8%85%E5%8D%95/">
    <span class="title">« 上一页</span>
    <br>
    <span>常用软件清单</span>
  </a>
  <a class="next" href="https://lzhuii.github.io/posts/vim%E9%85%8D%E7%BD%AE/">
    <span class="title">下一页 »</span>
    <br>
    <span>Vim 配置文件</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Hadoop 大数据平台搭建过程（集群） on x"
            href="https://x.com/intent/tweet/?text=Hadoop%20%e5%a4%a7%e6%95%b0%e6%8d%ae%e5%b9%b3%e5%8f%b0%e6%90%ad%e5%bb%ba%e8%bf%87%e7%a8%8b%ef%bc%88%e9%9b%86%e7%be%a4%ef%bc%89&amp;url=https%3a%2f%2flzhuii.github.io%2fposts%2fhadoop%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B3%25E5%258F%25B0%25E6%2590%25AD%25E5%25BB%25BA%25E8%25BF%2587%25E7%25A8%258B%25E9%259B%2586%25E7%25BE%25A4%2f&amp;hashtags=%e5%a4%a7%e6%95%b0%e6%8d%ae%2cHadoop%2cHive%2cSpark">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Hadoop 大数据平台搭建过程（集群） on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flzhuii.github.io%2fposts%2fhadoop%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B3%25E5%258F%25B0%25E6%2590%25AD%25E5%25BB%25BA%25E8%25BF%2587%25E7%25A8%258B%25E9%259B%2586%25E7%25BE%25A4%2f&amp;title=Hadoop%20%e5%a4%a7%e6%95%b0%e6%8d%ae%e5%b9%b3%e5%8f%b0%e6%90%ad%e5%bb%ba%e8%bf%87%e7%a8%8b%ef%bc%88%e9%9b%86%e7%be%a4%ef%bc%89&amp;summary=Hadoop%20%e5%a4%a7%e6%95%b0%e6%8d%ae%e5%b9%b3%e5%8f%b0%e6%90%ad%e5%bb%ba%e8%bf%87%e7%a8%8b%ef%bc%88%e9%9b%86%e7%be%a4%ef%bc%89&amp;source=https%3a%2f%2flzhuii.github.io%2fposts%2fhadoop%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B3%25E5%258F%25B0%25E6%2590%25AD%25E5%25BB%25BA%25E8%25BF%2587%25E7%25A8%258B%25E9%259B%2586%25E7%25BE%25A4%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Hadoop 大数据平台搭建过程（集群） on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2flzhuii.github.io%2fposts%2fhadoop%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B3%25E5%258F%25B0%25E6%2590%25AD%25E5%25BB%25BA%25E8%25BF%2587%25E7%25A8%258B%25E9%259B%2586%25E7%25BE%25A4%2f&title=Hadoop%20%e5%a4%a7%e6%95%b0%e6%8d%ae%e5%b9%b3%e5%8f%b0%e6%90%ad%e5%bb%ba%e8%bf%87%e7%a8%8b%ef%bc%88%e9%9b%86%e7%be%a4%ef%bc%89">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Hadoop 大数据平台搭建过程（集群） on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flzhuii.github.io%2fposts%2fhadoop%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B3%25E5%258F%25B0%25E6%2590%25AD%25E5%25BB%25BA%25E8%25BF%2587%25E7%25A8%258B%25E9%259B%2586%25E7%25BE%25A4%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Hadoop 大数据平台搭建过程（集群） on whatsapp"
            href="https://api.whatsapp.com/send?text=Hadoop%20%e5%a4%a7%e6%95%b0%e6%8d%ae%e5%b9%b3%e5%8f%b0%e6%90%ad%e5%bb%ba%e8%bf%87%e7%a8%8b%ef%bc%88%e9%9b%86%e7%be%a4%ef%bc%89%20-%20https%3a%2f%2flzhuii.github.io%2fposts%2fhadoop%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B3%25E5%258F%25B0%25E6%2590%25AD%25E5%25BB%25BA%25E8%25BF%2587%25E7%25A8%258B%25E9%259B%2586%25E7%25BE%25A4%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Hadoop 大数据平台搭建过程（集群） on telegram"
            href="https://telegram.me/share/url?text=Hadoop%20%e5%a4%a7%e6%95%b0%e6%8d%ae%e5%b9%b3%e5%8f%b0%e6%90%ad%e5%bb%ba%e8%bf%87%e7%a8%8b%ef%bc%88%e9%9b%86%e7%be%a4%ef%bc%89&amp;url=https%3a%2f%2flzhuii.github.io%2fposts%2fhadoop%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B3%25E5%258F%25B0%25E6%2590%25AD%25E5%25BB%25BA%25E8%25BF%2587%25E7%25A8%258B%25E9%259B%2586%25E7%25BE%25A4%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Hadoop 大数据平台搭建过程（集群） on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Hadoop%20%e5%a4%a7%e6%95%b0%e6%8d%ae%e5%b9%b3%e5%8f%b0%e6%90%ad%e5%bb%ba%e8%bf%87%e7%a8%8b%ef%bc%88%e9%9b%86%e7%be%a4%ef%bc%89&u=https%3a%2f%2flzhuii.github.io%2fposts%2fhadoop%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B3%25E5%258F%25B0%25E6%2590%25AD%25E5%25BB%25BA%25E8%25BF%2587%25E7%25A8%258B%25E9%259B%2586%25E7%25BE%25A4%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://lzhuii.github.io/">空影星辉</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
